# 提示词模板优化说明

## 优化背景

用户反馈：当任务类型是 CLASS、INTERFACE 或 ENUM 时，AI 会收到整个类/接口/枚举的代码，但只需要返回类级别的注释，不需要返回方法、字段等其他元素的注释。

## 优化内容

### 1. 类/接口/枚举模板优化

**文件**: `src/main/java/com/github/intellijjavadocai/settings/SettingsState.java`
**方法**: `getDefaultClassPromptTemplate()`

**优化前**:

```
你是一个专业的 Java 开发工程师，请为以下类生成完整的 JavaDoc 注释（中文）。
- 只返回新的 JavaDoc 注释，不要返回代码本身
```

**优化后**:

```
你是一个专业的 Java 开发工程师，请为以下类/接口/枚举生成类级别的 JavaDoc 注释（中文）。
- 只返回类/接口/枚举级别的 JavaDoc 注释，不要返回方法、字段等其他元素的注释
- 不要返回代码本身，只返回注释
```

**新增说明**:

- 明确说明只生成类/接口/枚举级别的注释
- 针对接口和枚举添加了专门的说明
- 增加了更多标签支持（@author、@version、@since）

### 2. 方法模板优化

**文件**: `src/main/java/com/github/intellijjavadocai/settings/SettingsState.java`
**方法**: `getDefaultMethodPromptTemplate()`

**优化前**:

```
你是一个专业的 Java 开发工程师，请为以下方法生成完整的 JavaDoc 注释（中文）。
- 只返回新的 JavaDoc 注释，不要返回代码本身
```

**优化后**:

```
你是一个专业的 Java 开发工程师，请为以下方法生成 JavaDoc 注释（中文）。
- 只返回方法级别的 JavaDoc 注释，不要返回类、字段等其他元素的注释
- 不要返回代码本身，只返回注释
```

**新增说明**:

- 明确说明只生成方法级别的注释
- 增加了更详细的示例，包含 @author 和 @since 标签

### 3. 字段模板优化

**文件**: `src/main/java/com/github/intellijjavadocai/settings/SettingsState.java`
**方法**: `getDefaultFieldPromptTemplate()`

**优化前**:

```
你是一个专业的 Java 开发工程师，请为以下字段生成 JavaDoc 注释（中文）。
- 只返回新的 JavaDoc 注释，不要返回代码本身
```

**优化后**:

```
你是一个专业的 Java 开发工程师，请为以下字段生成 JavaDoc 注释（中文）。
- 只返回字段级别的 JavaDoc 注释，不要返回类、方法等其他元素的注释
- 不要返回代码本身，只返回注释
```

### 4. 测试方法模板优化

**文件**: `src/main/java/com/github/intellijjavadocai/settings/SettingsState.java`
**方法**: `getDefaultTestPromptTemplate()`

**优化前**:

```
你是一个专业的 Java 开发工程师，请为以下测试方法生成完整的 JavaDoc 注释（中文）。
- 只返回新的 JavaDoc 注释，不要返回代码本身
```

**优化后**:

```
你是一个专业的 Java 开发工程师，请为以下测试方法生成 JavaDoc 注释（中文）。
- 只返回测试方法级别的 JavaDoc 注释，不要返回类、字段等其他元素的注释
- 不要返回代码本身，只返回注释
```

## 优化效果

### 1. 明确性提升

- 每个模板都明确说明只生成对应级别的注释
- 避免 AI 生成不相关的注释内容

### 2. 针对性增强

- 类模板：专门处理类/接口/枚举的注释
- 方法模板：专门处理方法注释
- 字段模板：专门处理字段注释
- 测试模板：专门处理测试方法注释

### 3. 一致性改善

- 所有模板都使用相同的格式和说明结构
- 统一了注释生成的要求和标准

## 技术细节

### 模板使用场景

- **CLASS/INTERFACE/ENUM**: 使用类模板，AI 收到整个类代码，只生成类级别注释
- **METHOD**: 使用方法模板，AI 收到方法代码，只生成方法注释
- **FIELD**: 使用字段模板，AI 收到字段代码，只生成字段注释
- **TEST_METHOD**: 使用测试模板，AI 收到测试方法代码，只生成测试方法注释

### 代码示例优化

- 类模板：增加了接口和枚举的说明
- 方法模板：增加了更详细的参数和返回值说明
- 字段模板：保持了单行/多行格式的区分
- 测试模板：保持了测试场景的描述要求

