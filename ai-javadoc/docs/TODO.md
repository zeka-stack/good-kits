# TODO List

本文档记录 IntelliJ AI Javadoc 插件的待办事项，按优先级和类别分类。

---

## 📌 图例说明

- 🔴 **高优先级** - 影响功能使用或用户体验的重要问题
- 🟡 **中优先级** - 功能增强和优化
- 🟢 **低优先级** - 锦上添花的改进

**状态标识**：

- ⬜ 待处理
- 🔄 进行中
- ✅ 已完成
- ⏸️ 暂停/搁置

---

## 🐛 Bug 修复

### 🔴 高优先级

- [x] **类注释被多次添加**
    - **问题描述**：为类生成 JavaDoc 时，多次执行会导致注释重复添加
    - **影响范围**：类级别的文档生成
    - **优先级**：🔴 高
    - **预估工作量**：2-3 小时
    - **相关文件**：`TaskCollector.java`, `TaskExecutor.java`
    - **解决思路**：
        - 检查类注释的删除逻辑是否与方法/字段不同
        - 可能需要特殊处理类的注释位置
        - 确保 `deleteOldDocComment()` 对类也有效

- [x] **非类注释多次添加时会新增空行**
    - **问题描述**：为方法/字段重新生成 JavaDoc 时，每次都会在注释前增加一个空行
    - **影响范围**：方法和字段的文档生成
    - **优先级**：🔴 高
    - **预估工作量**：1-2 小时
    - **相关文件**：`TaskExecutor.java` (第 255-323 行)
    - **解决思路**：
        - 检查插入位置的计算逻辑
        - 确认格式化后是否会添加额外空行
        - 可能需要在插入前清理多余的空行

- [ ] **无法查看 DEBUG 级别的日志**
    - **问题描述**：启用详细日志后，IDEA 日志中仍然看不到 DEBUG 级别的日志
    - **影响范围**：问题排查和调试
    - **优先级**：🔴 高
    - **预估工作量**：1 小时
    - **相关文件**：`log4j.properties`, IDEA 日志配置
    - **解决思路**：
        - 验证 `log4j.properties` 配置是否正确加载
        - 检查是否需要在 IDEA 中额外配置 Debug Log Settings
        - 添加日志配置验证逻辑
    - **参考文档**：`调试日志功能说明.md` 第 249-273 行

### 🟡 中优先级

- [ ] **重试机制的指数退避时间可能过长**
    - **问题描述**：在高频率请求时，重试等待时间可能导致用户等待过久
    - **影响范围**：API 请求失败重试
    - **优先级**：🟡 中
    - **预估工作量**：1 小时
    - **相关文件**：`OpenAICompatibleProvider.java` (第 151-158 行)
    - **建议**：添加最大等待时间上限，或提供可配置的重试策略

- [x] **异常处理不够细致**
    - **问题描述**：某些异常被笼统处理，用户无法获得准确的错误提示
    - **影响范围**：错误提示和用户反馈
    - **优先级**：🟡 中
    - **预估工作量**：2-3 小时
    - **相关文件**：所有 Action 类，`TaskExecutor.java`
    - **建议**：
        - 区分网络错误、配置错误、API 错误等
        - 提供更明确的错误提示和解决建议

- [x] **Progress Indicator 取消后任务可能继续执行**
    - **问题描述**：取消进度条后，后台任务可能还在继续
    - **影响范围**：资源占用和用户体验
    - **优先级**：🟡 中
    - **预估工作量**：1-2 小时
    - **相关文件**：`TaskExecutor.java`
    - **建议**：在关键点检查 `indicator.isCanceled()` 并及时中断

### 🟢 低优先级

- [ ] **大文件处理可能导致内存占用过高**
    - **问题描述**：对大文件或大量文件批量处理时内存占用较高
    - **影响范围**：大规模批量操作
    - **优先级**：🟢 低
    - **预估工作量**：3-4 小时
    - **建议**：实现流式处理或分批处理机制

- [ ] **网络超时配置可能不适合所有场景**
    - **问题描述**：默认超时时间对慢速网络或大模型可能不够
    - **影响范围**：特定网络环境下的使用
    - **优先级**：🟢 低
    - **预估工作量**：1 小时
    - **建议**：根据模型类型动态调整超时时间

---

## ✨ 新特性

### 🔴 高优先级

- [x] **添加自定义模型服务商**
    - **功能描述**：允许用户添加和配置自定义的 AI 服务商
    - **用户价值**：支持更多 AI 服务，提高插件灵活性
    - **优先级**：🔴 高
    - **预估工作量**：4-6 小时
    - **技术方案**：
        - 在设置面板添加"自定义服务商"选项
        - 支持配置自定义的 API 端点、请求格式、响应解析
        - 提供模板或向导帮助用户配置
    - **相关文件**：`AIServiceFactory.java`, `JavaDocSettingsPanel.java`
    - **依赖**：需要先完成 UI 优化（Tab 页）

- [ ] **对接星辰大模型**
    - **功能描述**：集成星辰大模型 API
    - **用户价值**：提供更多国产大模型选择
    - **优先级**：🔴 高
    - **预估工作量**：2-3 小时
    - **技术方案**：
        - 创建 `StepFunProvider.java` 继承 `OpenAICompatibleProvider`
        - 配置星辰大模型的默认 URL 和模型列表
        - 在 `AIServiceFactory` 中注册
    - **参考**：`QianWenProvider.java` 的实现方式
    - **文档**：[星辰大模型官方文档](https://platform.stepfun.com/)

- [x] **性能模式**
    - 在大量文件需要处理时,如果使用单个模型提供商只能串行处理, 所以如果检测到配置了多个服务提供商的话, 可以并行调用多个提供商进行处理
    - 设置页面测试成功后就添加到可用服务商列表, 当前选中的则作为默认服务提供商
    - 如果任务数(最小任务单元)大于 5 个, 则使用可用服务商进行负载调用
    - 提供一个设置选项: 性能模式
- [x] **调用服务商的模型列表而不是内置**
    - ollama: https://docs.ollama.com/api#endpoints
    - LM Studio: https://lmstudio.ai/docs/developer/openai-compat
    - 通义千问: https://help.aliyun.com/zh/model-studio/use-qwen-by-calling-api
    - 硅基流动: https://docs.siliconflow.cn/cn/api-reference/chat-completions/chat-completions

### 🟡 中优先级

- [ ] **智能 Prompt 优化建议**
    - **功能描述**：根据代码特征自动优化 Prompt
    - **用户价值**：提高生成质量，减少用户配置负担
    - **优先级**：🟡 中
    - **预估工作量**：6-8 小时
    - **技术方案**：
        - 分析代码复杂度、长度等特征
        - 动态调整 Prompt 的详细程度
        - 为不同场景提供最优 Prompt 模板
- [ ] **批量操作进度持久化**
    - **功能描述**：保存批量操作进度，支持暂停和恢复
    - **用户价值**：处理大量文件时可以随时中断和恢复
    - **优先级**：🟡 中
    - **预估工作量**：4-5 小时
    - **技术方案**：
        - 使用 JSON 文件保存任务队列和进度
        - 提供"继续上次任务"选项
        - 支持任务队列的导出和导入
- [ ] **代码上下文增强**
    - **功能描述**：在生成 JavaDoc 时，自动包含相关类、接口的信息
    - **用户价值**：提高生成的 JavaDoc 的准确性和关联性
    - **优先级**：🟡 中
    - **预估工作量**：5-6 小时
    - **技术方案**：
        - 分析类的继承关系、实现的接口
        - 提取相关方法的签名
        - 在 Prompt 中包含上下文信息
- [ ] **JavaDoc 质量评分和建议**
    - **功能描述**：评估生成的 JavaDoc 质量，提供改进建议
    - **用户价值**：帮助用户生成高质量文档
    - **优先级**：🟡 中
    - **预估工作量**：6-8 小时
    - **技术方案**：
        - 检查 JavaDoc 的完整性（参数、返回值、异常等）
        - 检查描述的详细程度
        - 提供评分和改进建议
- [ ] **多语言注释支持**
    - **功能描述**：支持生成英文、日文等多种语言的注释
    - **用户价值**：适应不同的项目和团队需求
    - **优先级**：🟡 中
    - **预估工作量**：3-4 小时
    - **技术方案**：
        - 在设置中添加语言选择
        - 为每种语言准备不同的 Prompt 模板
        - 支持多语言 Prompt 模板管理
- [ ] **JavaDoc 模板库**
    - **功能描述**：提供预设的 JavaDoc 模板，用户可以导入导出
    - **用户价值**：快速应用不同风格的文档规范
    - **优先级**：🟡 中
    - **预估工作量**：4-5 小时
    - **技术方案**：
        - 内置多种常见的文档风格模板
        - 支持模板的导入导出（JSON 格式）
        - 提供模板分享社区链接

- [ ] **Swagger 注解生成**

### 🟢 低优先级

- [ ] **代码质量检查集成**
    - **功能描述**：在生成文档的同时，提供代码质量建议
    - **用户价值**：一站式改进代码和文档质量
    - **优先级**：🟢 低
    - **预估工作量**：8-10 小时

- [ ] **团队协作功能**
    - **功能描述**：支持团队共享配置和模板
    - **用户价值**：统一团队文档风格
    - **优先级**：🟢 低
    - **预估工作量**：10-12 小时

- [ ] **支持其他语言**
    - **功能描述**：扩展到 Kotlin、Python、JavaScript 等语言
    - **用户价值**：扩大插件适用范围
    - **优先级**：🟢 低
    - **预估工作量**：每种语言 8-10 小时

---

## 🎨 UI/UX 优化

### 🔴 高优先级

- [x] **设置页面分 Tab 页**
    - **功能描述**：将设置页面拆分为多个 Tab 页，提高可读性, **为每个 tab 添加一个重置提示词按钮**
    - **优先级**：🔴 高
    - **预估工作量**：3-4 小时
    - **建议的 Tab 页**：
        1. **基础配置** - AI 提供商、API Key、模型选择
        2. **生成选项** - 生成范围、跳过选项、语言支持
        3. **高级配置** - 重试、超时、并发等参数
        4. **Prompt 模板** - 各类 Prompt 的配置
    - **相关文件**：`JavaDocSettingsPanel.java`
    - **技术方案**：使用 `JTabbedPane` 重构 UI 布局

- [x] **Prompt 输入框美化**
    - **功能描述**：优化 Prompt 输入框的样式和交互
    - **优先级**：🔴 高
    - **预估工作量**：2-3 小时
    - **改进点**：
        - 添加语法高亮（识别占位符 `%s`）
        - 添加行号显示
        - 优化字体和配色
        - 添加"恢复默认"按钮
        - 添加 Prompt 预览功能
    - **相关文件**：`JavaDocSettingsPanel.java`
    - **技术方案**：使用 `EditorTextField` 或自定义的 `JTextArea` 扩展

### 🟡 中优先级

- [ ] **设置页面分多个子页面**
    - **功能描述**：将复杂的配置项拆分到不同的子配置页面
    - **优先级**：🟡 中
    - **预估工作量**：4-6 小时
    - **建议的子页面**：
        - **AI Javadoc** (主页面)
        - **AI Javadoc | Prompt Templates** (Prompt 配置)
        - **AI Javadoc | Advanced** (高级配置)
    - **相关文件**：`plugin.xml`, `JavaDocSettingsConfigurable.java`
    - **技术方案**：使用 IntelliJ Platform 的 Configurable 层级结构

- [ ] **实时预览功能**
    - **功能描述**：在设置面板中实时预览生成效果
    - **优先级**：🟡 中
    - **预估工作量**：5-6 小时
    - **技术方案**：
        - 添加一个代码编辑器和预览区域
        - 用户修改 Prompt 后可以立即看到效果
        - 避免频繁调用 API（添加防抖）

- [ ] **配置导入导出**
    - **功能描述**：支持导出和导入配置文件
    - **优先级**：🟡 中
    - **预估工作量**：2-3 小时
    - **技术方案**：
        - 提供"导出配置"和"导入配置"按钮
        - 使用 JSON 格式存储配置
        - 支持部分配置导入（如只导入 Prompt 模板）

- [ ] **智能配置向导**
    - **功能描述**：首次使用时提供配置向导，引导用户完成初始设置
    - **优先级**：🟡 中
    - **预估工作量**：4-5 小时
    - **技术方案**：
        - 检测是否首次使用
        - 使用 Wizard 组件引导配置
        - 提供常见场景的快速配置选项

### 🟢 低优先级

- [ ] **暗色主题优化**
    - **功能描述**：优化暗色主题下的 UI 显示效果
    - **优先级**：🟢 低
    - **预估工作量**：2-3 小时

- [ ] **快捷键可自定义**
    - **功能描述**：允许用户自定义插件的快捷键
    - **优先级**：🟢 低
    - **预估工作量**：2 小时
    - **说明**：IDEA 已经支持自定义快捷键，此项可能无需开发

- [ ] **添加动画和过渡效果**
    - **功能描述**：在操作过程中添加流畅的动画效果
    - **优先级**：🟢 低
    - **预估工作量**：3-4 小时

---

## 🔧 技术优化和重构

### 🟡 中优先级

- [ ] **添加默认的代码格式化配置文件**
    - **功能描述**：提供统一的代码格式化配置（EditorConfig 或 IDEA 格式化配置）
    - **优先级**：🟡 中
    - **预估工作量**：1-2 小时
    - **技术方案**：
        - 添加 `.editorconfig` 文件
        - 或添加 IDEA 的 Code Style XML 配置
        - 在 README 中说明如何使用
    - **建议包含的配置**：
        - Java 缩进（4 空格）
        - 行长度限制
        - JavaDoc 格式规范
        - 导入顺序

- [ ] **单元测试覆盖率提升**
    - **功能描述**：为核心逻辑添加单元测试
    - **优先级**：🟡 中
    - **预估工作量**：8-10 小时
    - **建议覆盖的模块**：
        - `TaskCollector` - 任务收集逻辑
        - `TaskExecutor` - 任务执行逻辑
        - `OpenAICompatibleProvider` - API 调用逻辑
        - `PsiElementLocator` - PSI 元素定位逻辑

- [ ] **性能优化 - 缓存机制**
    - **功能描述**：为相同的代码缓存生成结果
    - **优先级**：🟡 中
    - **预估工作量**：3-4 小时
    - **技术方案**：
        - 使用代码的 Hash 作为缓存 Key
        - 缓存最近生成的文档
        - 提供清除缓存的选项

- [ ] **日志系统优化**
    - **功能描述**：优化日志输出，使其更易读和有用
    - **优先级**：🟡 中
    - **预估工作量**：2-3 小时
    - **改进点**：
        - 统一日志格式
        - 添加请求 ID 跟踪
        - 优化敏感信息脱敏逻辑
        - 添加性能统计日志

- [ ] **依赖更新和清理**
    - **功能描述**：更新过时的依赖，移除不必要的依赖
    - **优先级**：🟡 中
    - **预估工作量**：2-3 小时
    - **检查项**：
        - Gradle 插件版本
        - IntelliJ Platform SDK 版本
        - 第三方库版本
        - 移除未使用的依赖

### 🟢 低优先级

- [ ] **代码规范和静态分析**
    - **功能描述**：配置 Checkstyle、SpotBugs 等工具
    - **优先级**：🟢 低
    - **预估工作量**：3-4 小时

- [ ] **持续集成 CI/CD**
    - **功能描述**：配置 GitHub Actions 自动化构建和测试
    - **优先级**：🟢 低
    - **预估工作量**：4-5 小时
    - **功能**：
        - 自动运行测试
        - 自动构建插件
        - 自动检查代码规范
        - 自动发布到 JetBrains Marketplace

- [ ] **国际化 (i18n)**
    - **功能描述**：支持多语言界面
    - **优先级**：🟢 低
    - **预估工作量**：6-8 小时
    - **语言支持**：中文、英文

---

## 📚 文档完善

### 🔴 高优先级

- [ ] **更新 README**
    - **任务描述**：更新 README 以反映 v2.0 的变化
    - **优先级**：🔴 高
    - **预估工作量**：2-3 小时
    - **更新内容**：
        - 支持的 AI 提供商列表
        - 最新的功能特性
        - 详细的配置说明
        - 添加更多截图和 GIF 演示
    - **相关文件**：`README.md`, `README_CN.md`

### 🟡 中优先级

- [x] **用户手册**
    - **任务描述**：编写详细的用户手册
    - **优先级**：🟡 中
    - **预估工作量**：6-8 小时
    - **内容包括**：
        - 快速入门指南
        - 各功能的详细使用说明
        - 常见问题解答
        - 最佳实践
        - 故障排查指南

- [x] **开发者文档**
    - **任务描述**：编写开发者文档，方便社区贡献
    - **优先级**：🟡 中
    - **预估工作量**：4-6 小时
    - **内容包括**：
        - 架构设计文档
        - 如何添加新的 AI 提供商
        - 如何扩展功能
        - 代码规范
        - 提交指南

### 🟢 低优先级

- [ ] **API 文档生成**
    - **任务描述**：使用 JavaDoc 生成 API 文档
    - **优先级**：🟢 低
    - **预估工作量**：2-3 小时

- [ ] **贡献指南**
    - **任务描述**：编写详细的贡献指南
    - **优先级**：🟢 低
    - **预估工作量**：2-3 小时

---

## 🧪 测试相关

### 🟡 中优先级

- [ ] **集成测试**
    - **任务描述**：添加端到端的集成测试
    - **优先级**：🟡 中
    - **预估工作量**：8-10 小时
    - **测试场景**：
        - 完整的文档生成流程
        - 各种 AI 提供商的集成
        - 批量操作的完整流程
        - 异常场景的处理

- [ ] **性能测试**
    - **任务描述**：测试大规模批量操作的性能
    - **优先级**：🟡 中
    - **预估工作量**：4-5 小时
    - **测试指标**：
        - 单个文件生成耗时
        - 批量文件处理效率
        - 内存占用情况
        - 并发处理能力

### 🟢 低优先级

- [ ] **UI 测试**
    - **任务描述**：添加 UI 自动化测试
    - **优先级**：🟢 低
    - **预估工作量**：6-8 小时

- [ ] **压力测试**
    - **任务描述**：测试极限场景下的稳定性
    - **优先级**：🟢 低
    - **预估工作量**：3-4 小时

---

## 🚀 部署和发布

### 🟡 中优先级

- [ ] **发布到 JetBrains Marketplace**
    - **任务描述**：将插件发布到官方插件市场
    - **优先级**：🟡 中
    - **预估工作量**：3-4 小时
    - **准备工作**：
        - 完善插件描述和截图
        - 准备宣传材料
        - 设置定价策略（如果收费）
        - 准备技术支持渠道

### 🟢 低优先级

- [ ] **自动化发布流程**
    - **任务描述**：配置自动化发布到 Marketplace
    - **优先级**：🟢 低
    - **预估工作量**：3-4 小时

---

## 📊 优先级总结

### 立即处理（本周）

1. ✅ 修复类注释多次添加问题
2. ✅ 修复非类注释空行累积问题
3. ✅ 解决 DEBUG 日志不显示问题
4. 🎨 设置页面拆分为 Tab 页
5. 🎨 Prompt 输入框美化
6. ✨ 添加自定义模型服务商支持
7. ✨ 对接星辰大模型

### 近期处理（本月）

1. 🎨 设置页面分多个子页面
2. 🔧 添加代码格式化配置文件
3. ✨ 智能 Prompt 优化建议
4. ✨ 批量操作进度持久化
5. 📚 更新 README 和用户文档
6. 🚀 重新创建 Git 项目
7. 🧪 添加单元测试

### 中期规划（下个季度）

1. ✨ 代码上下文增强
2. ✨ JavaDoc 质量评分和建议
3. ✨ 多语言注释支持
4. ✨ JavaDoc 模板库
5. 🔧 性能优化和缓存机制
6. 📚 完整的用户手册和开发者文档
7. 🚀 发布到 JetBrains Marketplace

### 长期规划（未来）

1. ✨ 支持更多编程语言（Kotlin、Python 等）
2. ✨ 团队协作功能
3. ✨ 代码质量检查集成
4. 🔧 国际化支持
5. 🔧 持续集成 CI/CD
6. 🧪 完整的测试覆盖

---

## 📝 更新日志

- **2024-XX-XX**：创建 TODO 列表
    - 整理了 4 大类、50+ 个待办事项
    - 按优先级和类别进行了分类
    - 为每个任务添加了详细说明和预估工作量

---

## 🤝 贡献

如果你对某个任务感兴趣，欢迎：

1. 在对应的任务下评论表明你的兴趣
2. Fork 项目并创建分支
3. 完成后提交 Pull Request
4. 在 PR 中引用对应的 TODO 项目

---

## 📮 反馈

如果你有新的想法或建议，请：

1. 创建 GitHub Issue
2. 使用标签：`enhancement`（功能增强）、`bug`（问题修复）
3. 详细描述你的想法和预期效果

---

**最后更新**：2025.10.24

**维护者**：dong4j
