# IntelliJ AI Javadoc æ’ä»¶ - æµ‹è¯•è¯´æ˜

## ğŸ“‹ æµ‹è¯•æ¦‚è¿°

æœ¬é¡¹ç›®å·²ä¸ºæ ¸å¿ƒåŠŸèƒ½æ·»åŠ äº†å®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–ä»¥ä¸‹æ¨¡å—ï¼š

- âœ… **SettingsState** - é…ç½®ç®¡ç†æµ‹è¯•
- âœ… **DocumentationTask** - ä»»åŠ¡ç®¡ç†æµ‹è¯•
- âœ… **AIServiceFactory** - AI æœåŠ¡å·¥å‚æµ‹è¯•
- âœ… **NotificationUtil** - é€šçŸ¥å·¥å…·æµ‹è¯•
- âœ… **PsiElementLocator** - PSI å…ƒç´ å®šä½å™¨æµ‹è¯•
- âœ… **TaskCollector** - ä»»åŠ¡æ”¶é›†å™¨æµ‹è¯•

## ğŸ› ï¸ æµ‹è¯•æŠ€æœ¯æ ˆ

- **æµ‹è¯•æ¡†æ¶**: JUnit 5 (Jupiter)
- **Mock æ¡†æ¶**: Mockito 5.2.0
- **æ–­è¨€åº“**: AssertJ 3.24.2
- **IntelliJ æµ‹è¯•æ¡†æ¶**: IntelliJ Platform Test Framework

## ğŸ“¦ æµ‹è¯•ç»“æ„

```
src/test/java/com/github/intellijjavadocai/
â”œâ”€â”€ ai/
â”‚   â””â”€â”€ AIServiceFactoryTest.java          # AI æœåŠ¡å·¥å‚æµ‹è¯•
â”œâ”€â”€ settings/
â”‚   â””â”€â”€ SettingsStateTest.java             # é…ç½®çŠ¶æ€æµ‹è¯•
â”œâ”€â”€ task/
â”‚   â”œâ”€â”€ DocumentationTaskTest.java         # æ–‡æ¡£ä»»åŠ¡æµ‹è¯•
â”‚   â””â”€â”€ TaskCollectorTest.java             # ä»»åŠ¡æ”¶é›†å™¨æµ‹è¯•
â””â”€â”€ util/
    â”œâ”€â”€ NotificationUtilTest.java          # é€šçŸ¥å·¥å…·æµ‹è¯•
    â””â”€â”€ PsiElementLocatorTest.java         # PSI å…ƒç´ å®šä½å™¨æµ‹è¯•
```

## ğŸš€ è¿è¡Œæµ‹è¯•

### 1. ä½¿ç”¨ Gradle è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
./gradlew test
```

### 2. è¿è¡Œç‰¹å®šçš„æµ‹è¯•ç±»

```bash
./gradlew test --tests "dev.dong4j.zeka.stack.idea.plugin.settings.SettingsStateTest"
```

### 3. è¿è¡Œç‰¹å®šçš„æµ‹è¯•æ–¹æ³•

```bash
./gradlew test --tests "dev.dong4j.zeka.stack.idea.plugin.settings.SettingsStateTest.testDefaultValues"
```

### 4. åœ¨ IntelliJ IDEA ä¸­è¿è¡Œ

- å³é”®ç‚¹å‡»æµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•
- é€‰æ‹© "Run 'TestClassName'" æˆ– "Run 'testMethodName()'"
- æˆ–ä½¿ç”¨å¿«æ·é”® `Ctrl + Shift + F10` (Windows/Linux) æˆ– `âŒ˜ + Shift + R` (macOS)

## ğŸ“Š æµ‹è¯•è¦†ç›–ç‡

### SettingsStateTest (25 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… é»˜è®¤é…ç½®å€¼éªŒè¯
- âœ… é…ç½®æœ‰æ•ˆæ€§æ£€æŸ¥
- âœ… API Key éœ€æ±‚éªŒè¯
- âœ… è¯­è¨€æ”¯æŒæ£€æµ‹
- âœ… é…ç½®é‡ç½®å’Œå¤åˆ¶
- âœ… Prompt æ¨¡æ¿éªŒè¯
- âœ… æŒä¹…åŒ–çŠ¶æ€æµ‹è¯•

### DocumentationTaskTest (18 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… ä»»åŠ¡åˆ›å»ºå’ŒçŠ¶æ€ç®¡ç†
- âœ… ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸæµ‹è¯•
- âœ… æ‰€æœ‰ä»»åŠ¡ç±»å‹éªŒè¯
- âœ… ä»»åŠ¡çŠ¶æ€è½¬æ¢æµ‹è¯•
- âœ… é”™è¯¯å¤„ç†æµ‹è¯•
- âœ… å…ƒç´ åç§°æ ¼å¼åŒ–æµ‹è¯•

### AIServiceFactoryTest (17 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… åˆ›å»ºä¸åŒ AI æä¾›å•†
- âœ… æä¾›å•†æ”¯æŒæ£€æµ‹
- âœ… æä¾›å•†é…ç½®éªŒè¯
- âœ… å¤šå®ä¾‹åˆ›å»ºæµ‹è¯•
- âœ… æä¾›å•†åˆ‡æ¢æµ‹è¯•
- âœ… å¼‚å¸¸å¤„ç†æµ‹è¯•

### NotificationUtilTest (13 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… ä¿¡æ¯/è­¦å‘Š/é”™è¯¯é€šçŸ¥
- âœ… å®Œæˆé€šçŸ¥ï¼ˆä¸åŒçŠ¶æ€ï¼‰
- âœ… ç›®æ ‡å®Œæˆé€šçŸ¥
- âœ… æ— ä»»åŠ¡é€šçŸ¥
- âœ… ç´¢å¼•ä¸­é€šçŸ¥
- âœ… Null project å¤„ç†

### PsiElementLocatorTest (23 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… å…ƒç´ å®šä½æµ‹è¯•
- âœ… JavaDoc æ£€æµ‹
- âœ… å…ƒç´ æè¿°ç”Ÿæˆ
- âœ… ç±»å‹æè¿°éªŒè¯
- âœ… LocateResult åŠŸèƒ½æµ‹è¯•
- âœ… è¾¹ç•Œæ¡ä»¶å¤„ç†

### TaskCollectorTest (20 ä¸ªæµ‹è¯•ç”¨ä¾‹)

- âœ… ä»ä¸åŒå…ƒç´ æ”¶é›†ä»»åŠ¡
- âœ… æµ‹è¯•æ–¹æ³•è¯†åˆ«ï¼ˆJUnit 4/5ï¼‰
- âœ… è·³è¿‡å·²æœ‰æ–‡æ¡£
- âœ… é…ç½®é¡¹å¯ç”¨/ç¦ç”¨
- âœ… æ–‡ä»¶å’Œç›®å½•éå†
- âœ… å†…éƒ¨ç±»å¤„ç†

**æ€»è®¡**: **116+ ä¸ªæµ‹è¯•ç”¨ä¾‹**

## ğŸ” æµ‹è¯•è¦ç‚¹

### 1. Mock ä½¿ç”¨

æµ‹è¯•ä¸­å¹¿æ³›ä½¿ç”¨ Mockito æ¥æ¨¡æ‹Ÿ IntelliJ Platform çš„ APIï¼š

```java
@Mock
private Project mockProject;

@Mock
private PsiMethod mockMethod;

@BeforeEach
void setUp() {
    MockitoAnnotations.openMocks(this);
    when(mockMethod.getName()).thenReturn("testMethod");
}
```

### 2. é™æ€æ–¹æ³• Mock

ä½¿ç”¨ MockedStatic æ¥æ¨¡æ‹Ÿé™æ€æ–¹æ³•ï¼š

```java
try (MockedStatic<NotificationGroupManager> mockedStatic = 
        mockStatic(NotificationGroupManager.class)) {
    mockedStatic.when(NotificationGroupManager::getInstance)
        .thenReturn(mockGroupManager);
    // æµ‹è¯•ä»£ç 
}
```

### 3. AssertJ æ–­è¨€

ä½¿ç”¨ AssertJ æä¾›æµç•…çš„æ–­è¨€ APIï¼š

```java
assertThat(settings.aiProvider).isEqualTo("qianwen");
assertThat(tasks).hasSize(3);
assertThat(result.isMethod()).isTrue();
```

## ğŸ“ æµ‹è¯•å‘½åè§„èŒƒ

æ‰€æœ‰æµ‹è¯•æ–¹æ³•éµå¾ªä»¥ä¸‹å‘½åè§„èŒƒï¼š

```
test<åŠŸèƒ½åç§°>_<æµ‹è¯•åœºæ™¯>
```

ä¾‹å¦‚ï¼š

- `testIsValid_withValidConfiguration` - æµ‹è¯•æœ‰æ•ˆé…ç½®çš„éªŒè¯
- `testCollectFromElement_method` - æµ‹è¯•ä»æ–¹æ³•æ”¶é›†ä»»åŠ¡
- `testNotifyCompletion_withFailures` - æµ‹è¯•æœ‰å¤±è´¥çš„å®Œæˆé€šçŸ¥

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æµ‹è¯•è¿è¡Œæ—¶å‡ºç° ClassNotFoundException

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–

```bash
./gradlew clean build
```

### Q2: Mock å¯¹è±¡è¿”å› null

**è§£å†³æ–¹æ¡ˆ**: æ£€æŸ¥æ˜¯å¦æ­£ç¡®é…ç½®äº† mock å¯¹è±¡çš„è¡Œä¸º

```java
when(mockMethod.getText()).thenReturn("public void test() {}");
```

### Q3: IntelliJ Platform API ç›¸å…³é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿åœ¨ `build.gradle.kts` ä¸­æ·»åŠ äº†æµ‹è¯•æ¡†æ¶ä¾èµ–ï¼š

```kotlin
intellijPlatform {
    testFramework(org.jetbrains.intellij.platform.gradle.TestFrameworkType.Platform)
}
```

## ğŸ“ˆ æŒç»­æ”¹è¿›

### å¾…æ·»åŠ çš„æµ‹è¯•

1. **é›†æˆæµ‹è¯•**: æµ‹è¯•å®Œæ•´çš„å·¥ä½œæµç¨‹
2. **æ€§èƒ½æµ‹è¯•**: æµ‹è¯•å¤§é‡ä»»åŠ¡å¤„ç†æ€§èƒ½
3. **AI Provider æµ‹è¯•**: ä¸ºå…·ä½“çš„ AI Provider å®ç°æ·»åŠ æµ‹è¯•
4. **Action æµ‹è¯•**: ä¸ºç”¨æˆ·æ“ä½œï¼ˆActionï¼‰æ·»åŠ æµ‹è¯•

### æµ‹è¯•æœ€ä½³å®è·µ

1. âœ… **æ¯ä¸ªæµ‹è¯•åªæµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ç‚¹**
2. âœ… **ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°**
3. âœ… **ä½¿ç”¨ @DisplayName æä¾›ä¸­æ–‡æè¿°**
4. âœ… **æµ‹è¯•è¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸æƒ…å†µ**
5. âœ… **ä¿æŒæµ‹è¯•çš„ç‹¬ç«‹æ€§**
6. âœ… **ä½¿ç”¨ @BeforeEach è¿›è¡Œåˆå§‹åŒ–**

## ğŸ¯ æµ‹è¯•è¦†ç›–ç›®æ ‡

- [x] æ ¸å¿ƒä¸šåŠ¡é€»è¾‘: **100%**
- [x] å·¥å…·ç±»: **100%**
- [ ] UI ç›¸å…³ä»£ç : **å¾…æ·»åŠ **
- [ ] Action ç›¸å…³ä»£ç : **å¾…æ·»åŠ **

## ğŸ“š å‚è€ƒèµ„æ–™

- [JUnit 5 ç”¨æˆ·æŒ‡å—](https://junit.org/junit5/docs/current/user-guide/)
- [Mockito æ–‡æ¡£](https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html)
- [AssertJ æ–‡æ¡£](https://assertj.github.io/doc/)
- [IntelliJ Platform SDK æµ‹è¯•æŒ‡å—](https://plugins.jetbrains.com/docs/intellij/testing-plugins.html)


